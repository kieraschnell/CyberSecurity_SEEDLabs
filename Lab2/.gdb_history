break main
run
run
p system
p exit
quit
break main
run
run
p setuid
p system
find &system,+9999999, "/binsh"
find &system,+9999999,"/bin/sh"
find &system,+9999999,"/bin/sh"
quit
break main
p execv
run
run
p execv
quit
break main
run
run
p system
p exit
p buffer
exit
quit
break main
run
run
p system
p exit
quit
run
quit
break main
run
run
p system
p exit
quit
p execv
info address execv
break main
p execv
info address execv
break main
run
run
p execv
p &buffer
info frame
x/20x $esp
p &buffer
break
quit
break main
run
run
p &buffer
next
p &buffer
info locals
p &input
gdb-peda$ info locals
input = "\370\315\377\377\322\374;\003\214\316\377\377\340\263\374\367", '\000' <repeats 32 times>, "O\002\375\367\a\027\377\367\000\000\000\000_\232\177gP\333\377\367\214\316\377\377\242\027\375\367\275\306\375\367 \024\375\367\224\316\377\377\360\332\377\367\001\000\000\000\300\267\374\367\t\000\000\000\000\000\000\000\001\000\000\000\220\325\377\367\000\000\000\000p\001\375\367\003\000\000\000\360\001\375\367\220\334\377\367\254\316\377\377\000\000\000\000\000\320\377\367\000\000\000\000\000\000\000\000G\302\376\367p\000\000\000\262\027\375\367p\001\375\367 \302\376\367\000\320\377\367\a\000\000\000\001\000\000\000\377\377\377\377\a\000\000\000\214V\335\367"...
badfile = 0x565563d1 <__libc_csu_init+33>
length = 0xffffd27c
gdb-peda$ 
./ret;ib
./retlib
make
make clean
make
./retlib
pkill retlib
./retlib
pkill retlib
make clean
